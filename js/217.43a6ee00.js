"use strict";(self["webpackChunkdevice_management"]=self["webpackChunkdevice_management"]||[]).push([[217],{9217:(e,a,t)=>{t.r(a),t.d(a,{default:()=>L});var o=t(3673),n=t(8880);const l={class:"my-box column no-wrap"},r={class:"flex1 overflow-hidden"},i={class:"q-gutter-sm"};function s(e,a,t,s,m,c){const d=(0,o.up)("search-bar"),p=(0,o.up)("q-separator"),u=(0,o.up)("q-btn"),g=(0,o.up)("result-table");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(d,{searching:s.searching,onSearch:s.onSearch,onInsert:s.onInsert},null,8,["searching","onSearch","onInsert"]),(0,o.Wm)(p),(0,o._)("div",r,[(0,o.Wm)(g,{"row-key":"id",rows:s.rows,columns:s.columns,loading:s.searching,page:e.page,"page-size":e.pageSize,"total-count":e.totalCount,"total-page":e.totalPage,onPage:s.onPageChange},{op:(0,o.w5)((({row:e})=>[(0,o._)("div",i,[(0,o.Wm)(u,{title:"编辑",color:"primary",flat:"",dense:"",size:"11px",round:"",icon:"edit",onClick:(0,n.iM)((a=>s.onEdit(e)),["stop"])},null,8,["onClick"]),(0,o.Wm)(u,{title:"删除",color:"red-5",flat:"",dense:"",size:"11px",round:"",icon:"clear",onClick:(0,n.iM)((a=>s.onDel(e)),["stop"])},null,8,["onClick"])])])),_:1},8,["rows","columns","loading","page","page-size","total-count","total-page","onPage"])])])}t(9544);const m={class:"bg-white q-pl-md q-pb-md q-mt-md"},c=(0,o._)("span",{class:"text-caption text-bold"},"公司ID",-1),d=(0,o._)("span",{class:"text-caption text-bold"},"角色名称",-1);function p(e,a,t,n,l,r){const i=(0,o.up)("q-input"),s=(0,o.up)("q-btn"),p=(0,o.up)("q-form");return(0,o.wg)(),(0,o.iD)("div",m,[(0,o.Wm)(p,{class:"q-gutter-sm row items-center",onSubmit:n.onSubmit},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{outlined:"",dense:"",modelValue:n.companyId,"onUpdate:modelValue":a[0]||(a[0]=e=>n.companyId=e)},{prepend:(0,o.w5)((()=>[c])),_:1},8,["modelValue"]),(0,o.Wm)(i,{outlined:"",dense:"",modelValue:n.roleName,"onUpdate:modelValue":a[1]||(a[1]=e=>n.roleName=e)},{prepend:(0,o.w5)((()=>[d])),_:1},8,["modelValue"]),(0,o.Wm)(s,{icon:"search",color:"primary",dense:"",type:"submit",disable:t.searching},null,8,["disable"]),(0,o.Wm)(s,{icon:"add",color:"primary",dense:"",onClick:a[2]||(a[2]=a=>e.$emit("insert"))})])),_:1},8,["onSubmit"])])}var u=t(1959);const g={emits:["search","insert"],props:{searching:{type:Boolean,default:!1}},setup(e,{emit:a}){const t=(0,u.iH)(""),o=(0,u.iH)(""),n=()=>{a("search",{companyId:t.value,roleName:o.value})};return n(),{companyId:t,roleName:o,onSubmit:n}}};var f=t(4260),h=t(5269),y=t(4842),b=t(2165),w=t(7518),v=t.n(w);const k=(0,f.Z)(g,[["render",p]]),q=k;v()(g,"components",{QForm:h.Z,QInput:y.Z,QBtn:b.Z});var x=t(3514),_=t(8996),W=t(2323);const Z=e=>((0,o.dD)("data-v-1cee3d9d"),e=e(),(0,o.Cn)(),e),C={class:"row q-px-md q-py-xs items-center justify-between"},S={class:"text-body1"},I=Z((()=>(0,o._)("span",{class:"text-subtitle2 text-grey-8 text-bold"},"角色名称：",-1))),D=Z((()=>(0,o._)("span",{class:"text-subtitle2 text-grey-8 text-bold"},"备注：",-1)));function z(e,a,t,n,l,r){const i=(0,o.up)("q-btn"),s=(0,o.up)("q-separator"),m=(0,o.up)("q-input"),c=(0,o.up)("q-form"),d=(0,o.up)("q-scroll-area"),p=(0,o.up)("q-card-actions"),u=(0,o.up)("q-spinner-tail"),g=(0,o.up)("q-inner-loading"),f=(0,o.up)("q-card"),h=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(h,{persistent:"",ref:"dialogRef"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{class:"relative-positon overflow-hidden",style:{width:"292px","max-width":"98vw"}},{default:(0,o.w5)((()=>[(0,o._)("div",C,[(0,o._)("div",S,(0,W.zw)("insert"===t.type?"新增":"更新")+"角色信息 ",1),(0,o.Wm)(i,{flat:"",round:"",size:"12px",icon:"clear",onClick:n.onDialogHide},null,8,["onClick"])]),(0,o.Wm)(s),(0,o.Wm)(d,{style:{height:"130px","max-height":"50vh",padding:"16px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"row q-gutter-md items-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{dense:"",outlined:"","lazy-rules":"",class:"my-form-item",modelValue:e.roleName,"onUpdate:modelValue":a[0]||(a[0]=a=>e.roleName=a)},{prepend:(0,o.w5)((()=>[I])),_:1},8,["modelValue"]),(0,o.Wm)(m,{dense:"",outlined:"","lazy-rules":"",class:"my-form-item",modelValue:e.remark,"onUpdate:modelValue":a[1]||(a[1]=a=>e.remark=a)},{prepend:(0,o.w5)((()=>[D])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,o.Wm)(s),(0,o.Wm)(p,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{flat:"",label:"取消",color:"primary",onClick:n.onDialogHide},null,8,["onClick"]),(0,o.Wm)(i,{label:"确定",color:"primary",onClick:n.onSubmit},null,8,["onClick"])])),_:1}),(0,o.Wm)(g,{showing:n.loading,style:{"z-index":"100"}},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{color:"primary",size:"2em"})])),_:1},8,["showing"])])),_:1})])),_:1},512)}t(71);var N=t(1701),Q=t(5645);const H={emits:[...N.Z.emits],props:{type:{type:String,default:""},formData:{type:Object,default:()=>({})}},setup(e){const{dialogRef:a,onDialogOK:t,onDialogHide:o}=(0,N.Z)();let n=(0,u.qj)({companyId:1,remark:"",roleName:""});const l=(0,u.iH)(!1);if("edit"===e.type){console.log("formData",e.formData);const{id:a,companyId:t,remark:o,roleName:l}=(0,u.IU)(e.formData);n=(0,u.qj)({id:a,companyId:t,roleName:l,remark:o})}const r=()=>{l.value=!0;const a=(0,u.IU)(n);"insert"===e.type?Q.HB.insert(a).then((()=>{t()})).catch((()=>{})).finally((()=>{l.value=!1})):Q.HB.update(a).then((()=>{t()})).catch((()=>{})).finally((()=>{l.value=!1}))};return{dialogRef:a,...(0,u.BK)(n),loading:l,onSubmit:r,onDialogHide:o}}};var V=t(5926),B=t(151),P=t(5869),j=t(3e3),T=t(9367),U=t(6941),O=t(682);const R=(0,f.Z)(H,[["render",z],["__scopeId","data-v-1cee3d9d"]]),K=R;v()(H,"components",{QDialog:V.Z,QCard:B.Z,QBtn:b.Z,QSeparator:P.Z,QScrollArea:j.Z,QForm:h.Z,QInput:y.Z,QCardActions:T.Z,QInnerLoading:U.Z,QSpinnerTail:O.Z});var A=t(7689),E=t(8825);const F={components:{SearchBar:q,ResultTable:x.Z},setup(){const e=(0,E.Z)(),a=[{name:"roleName",field:"roleName",label:"角色名称",align:"left"},{name:"userName",field:"userName",label:"用户账号",align:"left"},{name:"companyName",field:"companyName",label:"所属公司",align:"left"},{name:"remark",field:"remark",label:"备注",align:"left"},{name:"createTime",field:"createTime",label:"创建时间",align:"left"},{name:"updateTime",field:"updateTime",label:"最后更新时间",align:"left"},{name:"op",label:"操作",field:"op",align:"center"}],t=(0,u.XI)([]),o=(0,u.qj)({page:1,pageSize:10,totalCount:0,totalPage:0}),n=(0,u.iH)(!1);let l;const r=()=>{n.value=!0,Q.HB.list(l).then((e=>{const{results:a,totalCount:n,totalPage:l}=e;t.value=a,o.totalCount=n,o.totalPage=l})).catch((()=>{})).finally((()=>{n.value=!1}))},i=e=>{o.page=1,l={...e,page:1,pageSize:o.pageSize},r(),console.log("searchData",l)},s=e=>{const{pageSize:a,page:t}=e;t&&(o.page=t),a&&(o.pageSize=a),l&&(l={...l,...e}),r()},m=()=>{e.dialog({component:K,componentProps:{type:"insert"}}).onOk((()=>{(0,A.t5)("增加成功"),i({page:1})}))},c=a=>{e.dialog({component:K,componentProps:{type:"edit",formData:a}}).onOk((()=>{(0,A.t5)("更新成功"),r()}))},d=a=>{e.dialog({component:_.Z,componentProps:{row:a}}).onOk((()=>{n.value=!0,Q.HB.del({id:a.id}).then((e=>{(0,A.t5)("删除成功"),r()})).catch((()=>{})).finally((()=>{n.value=!1}))}))};return{columns:a,rows:t,...(0,u.BK)(o),searching:n,onPageChange:s,onSearch:i,onInsert:m,onEdit:c,onDel:d}}},M=(0,f.Z)(F,[["render",s]]),L=M;v()(F,"components",{QSeparator:P.Z,QBtn:b.Z})}}]);